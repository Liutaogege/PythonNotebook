# Servlet原理

当Web服务器接收到一个HTTP请求时，它会先判断请求内容——如果是静态网页数据，Web服务器将会自行处理，然后产生响应信息；如果牵涉到动态数据，Web服务器会将请求转交给Servlet容器。此时Servlet容器会找到对应的处理该请求的Servlet实例来处理，结果会送回Web服务器，再由Web服务器传回用户端。

针对同一个Servlet，Servlet容器会在第一次收到http请求时建立一个Servlet实例，然后启动一个线程。第二次收到http请求时，Servlet容器无须建立相同的Servlet实例，而是启动第二个线程来服务客户端请求。所以多线程方式不但可以提高Web应用程序的执行效率，也可以降低Web服务器的系统负担。

```
1.Web Client 向Servlet容器（Tomcat）发出Http请求；

2.Servlet容器接收Web Client的请求；

3.Servlet容器创建一个HttpRequest对象，将Web Client请求的信息封装到这个对象中；

4.Servlet容器创建一个HttpResponse对象；

5.Servlet容器调用HttpServlet对象的service方法，把HttpRequest对象与HttpResponse对象作为参数传给 HttpServlet对象；

6.HttpServlet调用HttpRequest对象的有关方法，获取Http请求信息；

7.HttpServlet调用HttpResponse对象的有关方法，生成响应数据；

8.Servlet容器把HttpServlet的响应结果传给Web Client；
```

作者：Rick617
链接：https://www.jianshu.com/p/7dcd2c689729
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

## Mapping问题

1. 一个Servlet可以指定一个映射路径
   
   ```xml
   <servlet-mapping>
       <servlet-name>hello</servlet-name>
       <url-pattern>/hello</url-pattern>
     </servlet-mapping>
   ```

2. 一个Servlet也可以指定多个路径,当然本质上都是一个路径
   
   ```xml
     <!--  映射路径-->
       <servlet-mapping>
         <servlet-name>hello</servlet-name>
         <url-pattern>/hello</url-pattern>
       </servlet-mapping>
   
     <servlet-mapping>
       <servlet-name>hello</servlet-name>
       <url-pattern>/hello1</url-pattern>
     </servlet-mapping>
   
     <servlet-mapping>
       <servlet-name>hello</servlet-name>
       <url-pattern>/hello2</url-pattern>
     </servlet-mapping>
   ```

3. 一个Servlet可以指定通用映射路径（它也是浏览器打开的默认路径，即首页，所以小心它会覆盖首页）
   
   ```xml
   <servlet-mapping>
       <servlet-name>hello</servlet-name>
       <url-pattern>/*</url-pattern>
     </servlet-mapping>
   ```

4. 可以指定一些后缀或者前缀等等
   
   ```xml
     <servlet-mapping>
       <servlet-name>hello</servlet-name>
       <url-pattern>*.zip</url-pattern>
   <!--    <url-pattern>/*.zip</url-pattern>-->
   <!--    注意不能加上/会报错-->
     </servlet-mapping>
   
     <servlet-mapping>
       <servlet-name>hello</servlet-name>
       <url-pattern>/taotao.*</url-pattern>
     </servlet-mapping>
   ```

5. /*可以为错误访问地址返回指定的页面
   
   ```xml
   <servlet>
       <servlet-name>error</servlet-name>
       <servlet-class>com.test.servlet.ErrorServlet</servlet-class>
     在ErrorServlet类里定制返回的错误页面
   
     </servlet>
     <!--  映射路径-->
     <servlet-mapping>
       <servlet-name>error</servlet-name>
       <url-pattern>/*</url-pattern>
     </servlet-mapping>
   ```

6. 优先级问题
   
   如果指定了固有的映射路径优先级最高，如果找不到就会走默认的处理请求
