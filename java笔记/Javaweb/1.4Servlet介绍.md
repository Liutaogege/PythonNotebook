# Servlet

## 1.1 介绍

Servlet是一个==实现了Servlet接口==的类，一个与访问协议和平台无关的、==运行在Servlet容器中==的==Java程序==。

Servelt实现技术，sun公司提供了两个最重要的软件包：javax.servlet和javax.servlet.http。

javax.servlet是一个与通信协议无关的通用软件包;javax.servlet.http是一个支持HTTP访问协议的软件包，这两个软件包的同时存在，使得Servlet API能支持任何协议的请求/响应。

从狭义上来讲，Servlet 指的是 `javax.servlet.Servlet` 接口及其子接口，也可以指实现了Servlet 接口的实现类。



## 1.2 Servlet常用类和接口

![image-20211105072137818](/Users/jared/Library/Application Support/typora-user-images/image-20211105072137818.png)

主要类结构图：

![image-20211105072320285](/Users/jared/Library/Application Support/typora-user-images/image-20211105072320285.png)



## 1.3 Servlet接口

开发一个Servlet需要实现的基础接口： `public interface Servlet`。而GenericServlet是继承了它，HttpServlet又继承了GenericServlet。这里面最重要的方法就是service

该接口中定义的5个方法如下：

* init(ServletConfig config)：Servlet 初始化函数。初始化时 ServletConfig 会被传入
* ServletConfig getServletConfig()：获取 ServletConfig 对象
* service(ServletRequest req, ServletResponse res)：收到请求后的处理方法
* String getServletInfo()：返回此 Servlet 的描述信息
* void destroy()：Servlet 实例的销毁方法

具体讲解这5个方法：

1. init方法

   `public void init(ServletConfig config) throws ServletException`

   Servlet容器会在Servlet实例化之后，调用init方法对Servlet对象进行初始化，该方法由Servlet容器顺序调用，无需Servlet自身考虑何时执行。

2. getServletConfig()方法

   `public ServletConfig getServletConfig()`

   获取一个由Servlet容器创建的ServletConfig配置对象，这个对象常常用在Servlet初始化方法中，将初始化参数封装在ServletConfig对象中，然后传递给Servlet。

3. service方法

   `public void service(ServletRequest request,ServletResponse response) throws ServletException,IOException`

   当Servlet容器接收到客户请求时，调用service方法响应客户请求，service方法在Servlet实例化、初始化之后被调用，并且可以被多次调用。

4. getServletInfo方法

   `public String getServletInfo()`

   获取关于Servlet的一些相关信息，返回的字符串是纯文本格式而不带有任何标记(例如：HTML、XML等)。

5. destroy方法

   `public void destroy()`

   当Servlet实例从服务器中移除或服务停止时，Servlet容器调用destroy方法销毁Servlet实例。



## 1.4 与Servlet接口相关的接口

### 1.4.1 ServletConfig接口

Servlet配置信息接口，在Servlet初始化时，Servlet容器将Servlet初始化参数封装在ServletConfig对象中，并传递给Servlet，一个Servlet实例只有一个ServletConfig对象。

4个方法如下：

```
getInitParameter()：获取Servlet指定初始化参数的值

getInitParameterNames()：获取Servlet所有初始化参数名称

getServletContext()：获取Servlet容器为WEB应用创建的Servlet上下文环境对象ServletContext

getServletName()：获取Servlet名称
```

具体讲解这4个方法：

1. getInitParameter方法

   `public String getInitParameter(String name)`

   根据初始化参数名称，获取Servlet指定初始化参数的值，如果指定的参数不存在，返回空值null。

2. getInitParameterNames方法

   `public Enumeration getInitParameterNames()`

   获取Servlet所有初始化参数名称，如果Servlet没有初始化参数，返回一个空列表。

3. getServletContext方法

   `public ServletContext getServletContext()`

   获取Servlet容器为WEB应用创建的Servlet上下文环境对象ServletContext，WEB服务器启动的时候，在加载WEB应用时，为每个加载的WEB应用创建一个代表WEB应用Servlet上下文环境对象。

4. getServletName方法

   `public String getServletName()`

   获取正在访问的这个Servlet的名称。

### 1.4.2 ServletRequest接口

定义一个对象以向 servlet 提供客户端请求信息。servlet 容器创建一个`ServletRequest`对象并将其作为参数传递给 servlet 的`service`方法。

`ServletRequest`对象提供数据包括参数名称和值，属性，和的输入流。扩展的接口`ServletRequest`可以提供额外的特定于协议的数据。（查看[api](http://download.oracle.com/javaee/5/api/javax/servlet/ServletRequest.html)）

部分方法总结，更多详见官方文档

![image-20211105075229955](/Users/jared/Library/Application Support/typora-user-images/image-20211105075229955.png)

### 1.4.3 ServletResponse接口

响应客户端请求。（查看[api](http://download.oracle.com/javaee/5/api/javax/servlet/ServletResponse.html)）

定义一个对象以帮助 servlet 向客户端发送响应。servlet 容器创建一个`ServletResponse`对象并将其作为参数传递给 servlet 的`service`方法。

部分方法总结：

![image-20211105075419717](/Users/jared/Library/Application Support/typora-user-images/image-20211105075419717.png)