# 变量

局部变量：局部范围内生效，比如函数里面，或者复合语句里面，

全局变量：定义在函数之外的，在最开始定义的变量

```c
#include <stdio.h>
int a=0;
```



# 变量存储类别

在C语言中，供用户使用的存储空间分为三类，==程序区，静态存储区，动态存储区。==

程序区：存放的是可执行程序的机器指令

静态存储区:存放的是固定存储单元的变量，，比如全局变量。

动态存储区：存放的是在程序运行过程中根据需要动态分配内存空间的变量。比如形参，局部变量

变量的存储类别：指的是数据在内存中的存储方式。==变量的存储方式可分为两类：静态存储类和动态存储类==，具体包含四种：

==自动型（auto），静态型（static），寄存器型（register），外部型（extern）==



#### 1.局部变量的存储方式

局部变量有三种存储方式：自动型，静态型和寄存器型。

1. 自动变量
   函数中的局部变量，如果不特别的声明为static存储类别，都是动态地分配存储空间，数据存储在动态存储区中。在调用函数时，系统会给数据分配存储空间，在函数调用结束时，就会释放这些存储空间。所以这些变量被称为自动变量。
   ==自动变量用关键字auto作为存储类别的声明==

   ```c
   int func(int a) {
     auto int m,n;
   }
   // 如果不做特别声明，默认都是auto自动变量，auto关键字可以省略
   ```

   

2. 静态变量
   有时希望函数中的局部变量的值在函数调用结束后不消失而保留原值，即其占用的内存空间不被释放，在下一次函数调用时该变量已有值，此时就可以声明局部变量为“静态局部变量"，用关键字static进行声明。
   说明：
   （1）局部静态变量是静态存储区进行分配的存储单元；
   （2）局部静态变量是在程序编译过程中被赋值的，且只赋值一次，在程序运行时其初值已经确定；
   （3）布局静态变量的初值默认为0或空字符串（分别对应未赋值的整型变量和字符串变量）
   （4）其他函数不能引用本函数的局部静态变量！！！
   （5）少用它

   ```c
   void sum () {
     static int a=1;
     a++;
     printf("%d", a);
   }
   
   int main() {
     for (int i=0; i<3; i++) {
       sum();
     }
     // 每调用一次函数，a的值就会自动加一次
     return 0;
   }
   ```

   

3. 寄存器变量
   一般情况下，变量的值是存放到内存中的，当程序中用到哪一个变量的时候，控制器发出指令将内存中该变量的值送到运算器中。但如果一些值运用频繁，那么从内存中读取数据需要话费很多时间，为了提高程序运行速度，将局部变量的值放在CPU中的寄存器中，需要时直接从寄存器中读取数据，不必再跑到内存中读取数据，这种变量被称为寄存器变量。用关键字**register**进行声明
   说明：
   （1）只有局部自动变量和形式参数可以作为寄存器变量，其他类型的变量是不可以的。局部静态变量不能定义为寄存器变量（不能既放在静态存储区又放在寄存区，二者选一）；
   （2）电脑的寄存器数目有限，能定义的寄存器变量也是有限的，不能任意定超出多个。对寄存器的变量的处理方式不同的系统有可能有不同的处理方法（比如将它当做自动变量）

   ```c
   long func (int n) {
     register long i,f=1;
     for (i=1; i<=n; i++) {
       f=f*i;
     }
     return f;
   }
   // i和f都是寄存器变量，值越大，运行速率的提升越明显
   ```



#### 2.全局变量的存储方式

全局变量是在静态存储区中分配内存单元的，全局变量的存储类型有两种：外部类型（extern），静态类型（static）

1. 外部全局变量
   全局变量是在函数外部进行定义的（比如头文件的下方），它的作用域是从变量的定义处开始到本程序文件的结束。如果在定义点之前的函数想要使用该变量，==需要使用extern进行声明==（类型名可写可不写）；
   在一个文件中引用另一个文件的全局变量，也是需要使用**extern**进行声明；
   说明：
   （1）extern不能用来初始化变量，即extern int a=3是不合法的；
   （2）使用extern的作用是扩展全部变量的作用域
   （3）系统编译遇到extern时，现在本文件中查找该变量的定义，如果找不到，就从引入的文件进行查找

   ```c
   #include <stdio.h>
   
   int main() {
     extern A,B;
   }
   
   int A=1,B=2;
   
   void func() {
     
   }
   ```

   

2. 静态全部变量       
   有时候不希望本文件中的全局变量被其他文件引用，那么就可以把它声明为static类型。          
   在本文件中使用static声明的全局变量，在定义点之前是不能使用它的。定义全局变量的static相当于减小了全局变量的作用域。即用了static,extern就不生效了                                                                                 

   ```c
   // 不能使用的情况
   int main() {
     extern A;
     // 这里并不能引用变量A
   }
   
   static int A=5;
   ```

   

